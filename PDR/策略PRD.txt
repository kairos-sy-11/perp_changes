1. 核心逻辑确认
A. 资金费率 (Funding Rate) - 阶梯式告警 

不再是单一阈值，而是改为 4 个阶段 的分级监控：

第 1-3 阶段 (>0.5%, >1.0%, >1.8%，≥2.0%)：

首次进入区间触发。

冷却机制：同阶段内冷却 5 分钟。


第 4 阶段 (当资金费率之前≥2.0%，现在小于2.0%) - 高危模式 ：

首次触发时，3 分钟内连续通报 3 次（每分钟一次）。

B. 持仓量 (OI) - 引入“市值杠杆比” 

不再单纯看 OI 大小，引入了 流通市值 (Market Cap) 作为判断依据：

大户 (OI ≥ 3000万 U)：关注 ΔOI % ≥ 5%。

中户高杠杆 (OI < 3000万 U 且 OI/市值 > 0.3)：关注 ΔOI 绝对值 ≥ 100万 U。

小户低杠杆 (OI < 3000万 U 且 OI/市值 ≤ 0.3)：直接忽略，不报警。

C. CVD - 角色降级为“背景板” 

变更点：CVD 不再 单独触发报警（之前的“CVD > 500万”策略作废）。

新作用：仅作为 Funding 或 OI 报警时的附属信息。

数据要求：需要计算 5分钟 / 15分钟 / 30分钟 三个时间窗口的：

方向（净流入/流出）。

净流量数值。

占比（占当前总 CVD 的比例）。

2. 关键阻碍与确认事项（非常重要）
为了实现 PRD 中的 5.2 OI 策略，我们面临一个技术挑战：

❌ 缺失数据源：流通市值 (Circulating Market Cap)

问题：Binance U本位合约接口 (fapi) 不提供 代币的流通市值数据。它只有价格和成交量。

解决方案选项（请选择一项）：

方案 A（推荐，最稳妥）：调用 Binance 现货接口 (/api/v3/ticker/24hr 或 /api/v3/exchangeInfo) 获取大概的市值信息（需要额外写代码去映射 Symbol，例如 BTCUSDT 合约对应 BTCUSDT 现货）。注意：部分小币种可能没有准确的流通量数据。

方案 B（简化替代）：使用 24小时成交额 (24h Quote Volume) 代替市值进行计算。即 OI / 24h成交额 > 0.3。这在量化中常被用作流动性健康度的替代指标。

方案 C（硬编码/忽略）：MVP 阶段暂时忽略 OI / 市值 > 0.3 这个条件，所有小于 3000万 OI 的合约统一按“变动 > 100万 U”处理（这会回退到旧逻辑，但开发最快）。

您希望采用哪种方案处理“市值”数据？

3. 代码变更预告
确认需求后，我将对现有模块进行如下修改：

strategy.py (重写)：

实现复杂的 Funding 4级状态机（记录每个币当前处于哪个 Funding 阶段）。

实现 Stage 4 的“3分钟3连爆”逻辑。

实现 OI 的分层判断逻辑。

移除 CVD 的独立触发逻辑。

data_collector.py (升级)：

扩容：CVD 数据桶不仅要存 5 分钟，还要存 30 分钟 的历史数据，以支持 5/15/30m 的计算。

新增：获取市值数据（取决于您选择上面的哪个方案）。