# ğŸ”® Perp Monitor â€” å¸åœˆå…¨ç»´åº¦ç›‘æ§ç³»ç»Ÿ

å…¨å¼‚æ­¥å¤šæ¨¡å— 7Ã—24 åŠ å¯†è´§å¸å¸‚åœºç›‘æ§ç³»ç»Ÿï¼Œè¦†ç›–é“¾ä¸Š + CEX æ•°æ®ï¼Œé€šè¿‡ Telegram Bot å®æ—¶æ¨é€è­¦æŠ¥ã€‚

## ç³»ç»Ÿæ¶æ„

```
main.py â†’ MonitorSystem.start() â†’ asyncio.gather(12 ä¸ªå¹¶å‘ä»»åŠ¡)
                                        â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          æ•°æ®å±‚              â”‚          ç›‘æ§å±‚              â”‚
         â”‚                              â”‚                              â”‚
         â”‚  SymbolPoolManager           â”‚  StrategyEngine (ç­–ç•¥å¼•æ“)   â”‚
         â”‚  â”” ç›‘æ§æ± è‡ªåŠ¨ç»´æŠ¤             â”‚  SpreadMonitor (å…¨ç½‘ä»·å·®)    â”‚
         â”‚                              â”‚  OIComparer (OI å æ¯”å¯¹æ¯”)    â”‚
         â”‚  DataCollector               â”‚  ListingMonitor (ä¸Šå¸ç›‘æ§)   â”‚
         â”‚  â”œ WebSocket å®æ—¶æˆäº¤æµ       â”‚  AnnouncementMonitor (å…¬å‘Š)  â”‚
         â”‚  â”” REST è½®è¯¢ OI/Funding      â”‚  OnChainMonitor (é“¾ä¸Šå¼‚åŠ¨)   â”‚
         â”‚                              â”‚  WalletMonitor (å……æçŠ¶æ€)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚        äº¤äº’å±‚                â”‚          é€šçŸ¥å±‚              â”‚
         â”‚                              â”‚                              â”‚
         â”‚  TelegramCommander           â”‚  TelegramNotifier            â”‚
         â”‚  â”” Bot æŒ‡ä»¤æ§åˆ¶å°             â”‚  â”” ç»Ÿä¸€æ¶ˆæ¯æ¨é€              â”‚
         â”‚                              â”‚                              â”‚
         â”‚  WebServer (FastAPI)         â”‚                              â”‚
         â”‚  â”” Web UI + API æ¥å£         â”‚                              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åŠŸèƒ½æ¨¡å—

### ğŸ“Š æ•°æ®é‡‡é›†

| æ¨¡å— | æ•°æ®æº | é¢‘ç‡ |
|------|--------|------|
| **ç›‘æ§æ± ** (`SymbolPoolManager`) | Binance æ°¸ç»­åˆçº¦åˆ—è¡¨ | 20 åˆ†é’Ÿå¢é‡ / 7 å¤©å…¨é‡ |
| **WebSocket** (`DataCollector.run_ws`) | `fstream.binance.com` aggTrade | å®æ—¶ |
| **REST è½®è¯¢** (`DataCollector.run_rest_poller`) | Binance OI + Funding API | æ¯ 30 ç§’ |

### ğŸ”” ç›‘æ§æŠ¥è­¦

| æ¨¡å— | åŠŸèƒ½ | é¢‘ç‡ | è§¦å‘æ¡ä»¶ |
|------|------|------|---------|
| **ç­–ç•¥å¼•æ“** | ä»·æ ¼/OI/èµ„é‡‘è´¹ç‡å¼‚åŠ¨ | 5 ç§’ | ä»·æ ¼æ¶¨è·Œ >3-10%ã€OI çªå˜ >$100 ä¸‡ä¸” >5%ã€è´¹ç‡ >0.5% |
| **å…¨ç½‘ä»·å·®** | Binance vs å¤šäº¤æ˜“æ‰€ä»·å·® | 15 ç§’ | ä»·å·® >5%ï¼ˆå« Upbit æ³¡èœæº¢ä»·æ¢ç®—ï¼‰ |
| **OI å æ¯”** | å…¶ä»–äº¤æ˜“æ‰€ vs Binance OI æ¯”å€¼ | 60 ç§’ | Bybit/OKX >50%ã€Bitget/Gate >30% |
| **ä¸Šå¸ç›‘æ§** | Binance ç°è´§+åˆçº¦ + Upbit | 60 ç§’ | å‘ç°æ–°äº¤æ˜“å¯¹ |
| **å…¬å‘Šç›‘æ§** | Binance + Upbit å…¬å‘Šé¡µ | 30 ç§’ | ä¸Šå¸/å¼€æ”¾äº¤æ˜“ç±»å…¬å‘Š |
| **é“¾ä¸Šå¼‚åŠ¨** | ETH/BSC/ARB/OP/Polygon | 60 ç§’ | é’±åŒ…ä½™é¢å˜åŒ– |
| **å……æçŠ¶æ€** | 5 å¤§äº¤æ˜“æ‰€å……æå¼€å…³ | 5 åˆ†é’Ÿ | å……å€¼/æç°çŠ¶æ€å˜æ›´ |

### ğŸ¤– äº¤äº’æ§åˆ¶

**Telegram Bot æŒ‡ä»¤ï¼š**
- `/list` â€” æŸ¥çœ‹é“¾ä¸Šç›‘æ§åˆ—è¡¨
- `/add é“¾ é’±åŒ…åœ°å€ ä»£å¸åˆçº¦ å¤‡æ³¨` â€” æ·»åŠ é“¾ä¸Šç›‘æ§
- `/del åºå·` â€” åˆ é™¤é“¾ä¸Šç›‘æ§
- `/help` â€” å¸®åŠ©

**Web UIï¼ˆç«¯å£ 8000ï¼‰ï¼š**
- å¸‚åœºå¼‚åŠ¨é¢æ¿ã€OI å¯¹æ¯”ã€ä»·å·®æ•°æ®ã€é“¾ä¸Šåœ°å€ã€ä¸Šå¸å†å²ã€å……æçŠ¶æ€ã€TG å†å²

## é¡¹ç›®ç»“æ„

```
perp_changes/
â”œâ”€â”€ main.py                  # å…¥å£ (CLI æ¨¡å¼)
â”œâ”€â”€ web_server.py            # å…¥å£ (Web æ¨¡å¼, FastAPI)
â”œâ”€â”€ config.py                # å…¨å±€é…ç½® (Token/é˜ˆå€¼/ä»£ç†)
â”œâ”€â”€ monitor_pool.py          # ç›‘æ§æ± ç®¡ç† + MonitorSystem ä¸»ç±»
â”œâ”€â”€ data_collector.py        # æ•°æ®é‡‡é›† (WS + REST)
â”œâ”€â”€ strategy.py              # ç­–ç•¥å¼•æ“
â”œâ”€â”€ notifier.py              # Telegram æ¶ˆæ¯å‘é€
â”œâ”€â”€ telegram_commander.py    # Telegram Bot æŒ‡ä»¤ç›‘å¬
â”œâ”€â”€ spread_monitor.py        # å…¨ç½‘ä»·å·®ç›‘æ§
â”œâ”€â”€ oi_comparer.py           # è·¨äº¤æ˜“æ‰€ OI å¯¹æ¯”
â”œâ”€â”€ listing_monitor.py       # ä¸Šå¸ç›‘æ§
â”œâ”€â”€ announcement_monitor.py  # å…¬å‘Šç›‘æ§
â”œâ”€â”€ onchain_monitor.py       # é“¾ä¸Šåœ°å€ç›‘æ§
â”œâ”€â”€ wallet_monitor.py        # å……æçŠ¶æ€ç›‘æ§
â”œâ”€â”€ monitor_pool.json        # ç›‘æ§æ± æŒä¹…åŒ–
â”œâ”€â”€ onchain_targets.json     # é“¾ä¸Šç›‘æ§ç›®æ ‡æŒä¹…åŒ–
â”œâ”€â”€ templates/index.html     # Web UI é¡µé¢
â”œâ”€â”€ deploy.sh                # VPS ä¸€é”®éƒ¨ç½²è„šæœ¬
â””â”€â”€ requirements.txt         # Python ä¾èµ–
```

## éƒ¨ç½²

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- Linux VPSï¼ˆå¯ç›´è¿ Telegram APIï¼‰

### ä¸€é”®éƒ¨ç½²

```bash
git clone https://github.com/kairos-sy-11/perp_changes.git ~/perp_monitor
cd ~/perp_monitor
bash deploy.sh
```

`deploy.sh` ä¼šè‡ªåŠ¨å®Œæˆï¼šå®‰è£…ä¾èµ– â†’ åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ â†’ å»é™¤ä»£ç† â†’ é…ç½® systemd æœåŠ¡ â†’ å¯åŠ¨

### å¸¸ç”¨è¿ç»´å‘½ä»¤

```bash
sudo systemctl status perp-monitor     # æŸ¥çœ‹çŠ¶æ€
sudo journalctl -u perp-monitor -f     # å®æ—¶æ—¥å¿—
sudo systemctl restart perp-monitor    # é‡å¯
sudo systemctl stop perp-monitor       # åœæ­¢
```

## é…ç½®è¯´æ˜ (`config.py`)

| é…ç½®é¡¹ | è¯´æ˜ |
|--------|------|
| `telegram.bot_token` | Telegram Bot Token |
| `telegram.chat_id` | æ¥æ”¶æ¶ˆæ¯çš„ Chat ID |
| `proxy` | ä»£ç†åœ°å€ï¼ˆVPS ä¸Šè®¾ä¸ºç©ºï¼‰ |
| `thresholds.*` | å„æ¨¡å—æŠ¥è­¦é˜ˆå€¼ |
| `onchain.rpcs` | å„é“¾ RPC èŠ‚ç‚¹åœ°å€ |

## å†…å­˜å ç”¨

ç³»ç»Ÿä½¿ç”¨æœ‰ç•Œ `deque` æ§åˆ¶å†…å­˜ï¼Œçº¦ 300 ä¸ªå¸ç§é•¿æœŸè¿è¡Œå ç”¨ **~100-150 MB**ï¼Œ512MB ä»¥ä¸Š VPS å³å¯ç¨³å®šè¿è¡Œã€‚
